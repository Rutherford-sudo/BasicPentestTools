from scapy.all import *
import argparse

def scan(ip):
    
    answered = srp(Ether(dst="ff:ff:ff:ff:ff:ff")/ARP(pdst=ip),timeout=1, verbose=False)[0]
    
    

    clients_list = []

    for element in answered:
        clients_dict = {"ip": element[1].psrc, "mac": element[1].hwsrc}
        clients_list.append(clients_dict)

    return clients_list

def print_result(result_list):

    print("IP\t\t\tMAC Address")
    print("-"*43)
    for client in result_list:
        print(client["ip"] + "\t\t" + client["mac"])

result_list = scan("192.168.0.0/24")
print_result(result_list)